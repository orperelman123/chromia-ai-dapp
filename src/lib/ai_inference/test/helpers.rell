module;

import ^^.*;
import hc: ^^^.hybridcompute;
import ^^^.hybridcompute.test.helpers;

operation submit_inference_request_op(id: text, prompt: text, stop: text?) {
    submit_inference_request(id, prompt, stop);
}

operation submit_chat_inference_request_op(id: text, messages: list<chat_message>) {
    submit_chat_inference_request(id, messages);
}

object result {
    mutable id: text = "";
    mutable result: text = "";
    mutable error: text = "";
}

@extend(on_inference_result)
function (id: text, inference_result) {
    result.id = id;
    result.result = inference_result.result ?: "";
    result.error = inference_result.error ?: "";
}
